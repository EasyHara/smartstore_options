<script>
function openTrashBin() {
  const trashDiv = document.getElementById('trashBin');
  const trashList = document.getElementById('trashList');
  const trash = JSON.parse(localStorage.getItem('smartstore_trash') || '{}');

  const now = new Date();
  let hasContent = false;
  trashList.innerHTML = '';

  Object.entries(trash).forEach(([title, info]) => {
    const deletedDate = new Date(info.deletedAt);
    const diffDays = (now - deletedDate) / (1000 * 60 * 60 * 24);
    const remainingDays = Math.ceil(7 - diffDays);
    if (diffDays < 7) {
      hasContent = true;
      const item = document.createElement('div');
      item.className = 'template-item';
      item.innerHTML = `
        <div>
          <b>${title}</b><br>
          <small>삭제일: ${deletedDate.toLocaleString()} | 남은 보관일: ${remainingDays}일</small>
        </div>
        <button onclick="restoreTemplate('${title}')">복원</button>
      `;
      trashList.appendChild(item);
    }
  });

  if (!hasContent) {
    alert('휴지통이 비어있습니다.');
    trashDiv.style.display = 'none';
  } else {
    trashDiv.style.display = 'block';
    const notice = document.createElement('p');
    notice.innerText = '휴지통은 삭제일로부터 7일 후 자동 비워집니다.';
    notice.style.fontSize = '0.9em';
    notice.style.color = '#555';
    trashList.prepend(notice);
  }
}
</script>
