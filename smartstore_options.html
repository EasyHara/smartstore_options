<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>스마트스토어 옵션 자동 생성기</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <style>
    /* ───────────────────────────────────────────────────────────── */
    /* 박스 모델 통일 */
    *, *::before, *::after { box-sizing: border-box; }

    body {
      font-family: 'Pretendard', sans-serif;
      padding: 20px;
      background: #f5f6fa;
      color: #333;
    }
    .container {
      max-width: 100%;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
      overflow-x: auto;
    }
    h1 { font-size: 24px; margin-bottom: 16px; }

    /* 테이블 기본 스타일 */
    table {
      width: 100%;
      min-width: 1200px;
      border-collapse: collapse;
      margin: 10px 0;
      table-layout: fixed;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
      font-size: 14px;
      word-break: break-word;
      vertical-align: middle;
    }
    th { background-color: #f0f0f0; }

    /* 버튼·파일·인풋 기본 스타일 */
    button,
    input[type="file"],
    input[type="number"],
    input[type="text"] {
      margin: 4px;
      padding: 6px 10px;
      font-size: 14px;
      height: 36px;
      line-height: 1.2;
      vertical-align: middle;
    }

    /* 테이블 내부 input width 통일 */
    #inputTable td input[type="text"],
    #inputTable td input[type="number"] {
      width: 100%;
    }

    /* 라디오·체크박스 중앙 정렬 */
    #inputTable td input[type="radio"],
    #inputTable td input[type="checkbox"] {
      display: block;
      margin: auto;
      transform: scale(1.2);
    }

    /* 칼럼 폭 조정 */
    #inputTable th:nth-child(1), #inputTable td:nth-child(1) { width: 5%; }
    #inputTable th:nth-child(2), #inputTable td:nth-child(2) { width: 20%; }
    #inputTable th:nth-child(3), #inputTable td:nth-child(3) { width: 15%; }
    #inputTable th:nth-child(4), #inputTable td:nth-child(4) { width: 15%; }
    #inputTable th:nth-child(5), #inputTable td:nth-child(5) { width: 15%; }
    #inputTable th:nth-child(6), #inputTable td:nth-child(6) { width: 15%; }
    #inputTable th:nth-child(7), #inputTable td:nth-child(7) { width: 10%; }
    #inputTable th:nth-child(8), #inputTable td:nth-child(8) { width: 5%; }
  </style>
</head>
<body>
  <div class="container">
    <h1>📃 스마트스토어 옵션 자동 생성기</h1>
    <input type="file" id="inputFile" accept=".xls,.xlsx">
    <button onclick="downloadTemplate()">엑셀 양식 다운로드</button>

    <div style="position: relative; background: #f8f9fc; padding: 16px 20px; margin-bottom: 24px; border-radius: 10px; font-size: 14px; color: #333; line-height: 1.8; box-shadow: 0 0 0 1px #e5e7eb;">
      <a href="https://github.com/EasyHara/smartstore_options/blob/main/smartstore_options.html" target="_blank" style="position: absolute; top: 12px; right: 16px; background: #f8f9fc; color: #2563eb; font-weight: 500; font-size: 14px; text-decoration: none; padding: 4px 10px; border: 1px solid #d1d5db; border-radius: 6px;">웹 파일</a>
      <strong style="font-size: 15px; display: block; margin-bottom: 8px; color: #1f2937;">사이즈 입력 방법 안내</strong>
      <ul style="list-style: disc; padding-left: 20px; margin: 0;">
        <li><strong>범위 입력:</strong> <code>230~240</code> → <span style="color:#2563eb; font-weight: 600;">5단위 자동 생성</span> <span style="color: #888;">(예: 230, 235, 240)</span></li>
        <li><strong>개별 입력:</strong> <code>230,235/245</code> → 쉼표 또는 슬래시로 <span style="color:#2563eb; font-weight: 600;">사이즈 직접 지정</span></li>
        <li><span style="color:#2563eb; font-weight: 600;">네이버 규정에 따라 미달, 초과된 옵션은 다운로드시 자동으로 없어집니다</span></li>
      </ul>
    </div>

    <div style="margin: 20px auto; display: flex; justify-content: center; align-items: center; gap: 24px; flex-wrap: wrap;">
      <span style="font-weight: 500;">옵션 노출 방식:</span>
      <label><input type="radio" name="optionDisplay" value="both" checked> 색상&사이즈 모두</label>
      <label><input type="radio" name="optionDisplay" value="colorOnly"> 색상만</label>
      <label><input type="radio" name="optionDisplay" value="sizeOnly"> 사이즈만</label>

      <label for="discountRate" style="font-weight: 500;">옵션가 계산 기준 할인률 (%)</label>
      <input type="number" id="discountRate" value="0" min="0" max="99" step="1" style="width: 60px; text-align: right;">%
      <span style="color: #888; font-size: 13px;">(네이버할인가 기준)</span>
    </div>

    <table id="inputTable">
      <thead>
        <tr>
          <th>선택</th><th>상품명</th><th>판매가(네이버할인가)</th><th>색상</th><th>사이즈</th><th>1번 상품명</th><th>품절된 색상,사이즈</th><th>옵션에서 제외</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <button onclick="addRow()">+ 행 추가</button>
    <button onclick="clearTable()">초기화</button>
    <br><br>
    <div style="text-align: center; margin-top: 20px;">
      <button onclick="downloadRepresentative()">선택상품 엑셀 다운로드</button>
      <button onclick="generateZip()">일괄 엑셀 다운로드 (ZIP)</button>
      <button onclick="downloadAddProductExcel()">추가상품 엑셀 다운로드</button>
      <button onclick="downloadSingleProductExcel()">단품등록 엑셀 다운로드</button>
      <button onclick="downloadSingleProductExcelAll()">단품등록 엑셀 전체다운로드</button>
</div>
  </div>

  <script>
  // 옵션가 유효성 검사 함수 (네이버 규정 반영)
function isValidOptionPrice(basePrice, diff) {
  if (basePrice < 2000) {
    return diff >= 0 && diff <= basePrice * 1.0;
  } else if (basePrice < 10000) {
    return diff >= basePrice * -0.5 && diff <= basePrice * 1.0;
  } else {
    return diff >= basePrice * -0.5 && diff <= basePrice * 0.5;
  }
}


  // 할인률 기준으로 원래 판매가 계산
  function calculateOriginalPrice(salePrice, discountRate) {
    const raw = salePrice / (1 - discountRate / 100);
    return Math.round(raw / 100) * 100;  // 100원 단위 반올림
  }
    document.getElementById("inputFile").addEventListener("change", function(e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function(evt) {
        const data = new Uint8Array(evt.target.result);
        const workbook = XLSX.read(data, { type: 'array' });

        const sheetName = workbook.SheetNames.find(name =>
          name.includes("상품") || name.includes("옵션")
        ) || workbook.SheetNames[0];

        const sheet = workbook.Sheets[sheetName];
        if (!sheet) return alert("상품옵션 시트를 찾을 수 없습니다.");

        const json = XLSX.utils.sheet_to_json(sheet, { defval: "" });

        clearTable();
        json.forEach(row => addRow({
          상품명: row["상품명"],
          판매가: row["판매가"],
          색상: row["색상"],
          사이즈: row["사이즈"],
          ["1번 상품명"]: row["1번 상품명"],
          품절된조합: row["품절된 조합"] || '',
          제외: row["제외"] === 'Y' || row["제외"] === true
        }));
      };
      reader.readAsArrayBuffer(file);
    });

    function addRow(data = {}) {
      const tbody = document.querySelector("#inputTable tbody");
      const row = document.createElement("tr");
      row.innerHTML = `
        <td><input type="radio" name="대표"></td>
        <td><input value="${data.상품명 || ''}"></td>
        <td><input value="${data.판매가 || ''}" type="number"></td>
        <td><input value="${data.색상 || ''}"></td>
        <td><input value="${data.사이즈 || ''}"></td>
        <td><input value="${data["1번 상품명"] || ''}"></td>
        <td><input value="${data.품절된조합 || ''}"></td>
        <td><input type="checkbox" ${data.제외 ? 'checked' : ''}></td>
      `;
      tbody.appendChild(row);
    }

    function clearTable() {
      document.querySelector("#inputTable tbody").innerHTML = '';
      document.getElementById("inputFile").value = "";
    }

    function getDataFromTable() {
      const rows = document.querySelectorAll("#inputTable tbody tr");
      return Array.from(rows).map(row => {
        const cells = row.querySelectorAll("input");
        return {
          대표: cells[0]?.checked ?? false,
          상품명: cells[1]?.value?.trim() || "",
          판매가: parseInt(cells[2]?.value) || 0,
          색상: cells[3]?.value?.trim() || "",
          사이즈: cells[4]?.value?.trim() || "",
          ["1번 상품명"]: cells[5]?.value?.trim() || "",
          품절된조합: cells[6]?.value?.trim() || "",
          제외: cells[7]?.checked ?? false
        };
      });
    }

    function downloadTemplate() {
      const headers = ["상품명", "판매가", "색상", "사이즈", "1번 상품명", "품절된 조합", "제외"];
      const ws = XLSX.utils.aoa_to_sheet([headers]);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "상품옵션");
      const wbout = XLSX.write(wb, { bookType: 'xls', type: 'array' });
      saveAs(new Blob([wbout], { type: "application/octet-stream" }), `스스_옵션양식.xls`);
    }

// 대표상품 기준 엑셀 다운로드
function downloadRepresentative() {
  const rows = getDataFromTable().filter(r => !r.제외);
  if (!rows.length) return alert("출력할 데이터가 없습니다.");

  const 대표 = rows.find(r => r.대표) || rows[0];
  const 할인률 = parseFloat(document.getElementById("discountRate").value) || 0;
  const 대표정가 = calculateOriginalPrice(대표.판매가, 할인률);
  const mode = getOptionDisplayMode();
  let data = [];

  // 1) 옵션 데이터 수집
  rows.sort((a,b)=>(a===대표?-1:b===대표?1:0)).forEach(item=>{
    const 옵션가 = item.판매가 - 대표.판매가;
    if (!isValidOptionPrice(대표정가, 옵션가)) return;

    const 제품명 = (item===대표 && item["1번 상품명"] && item["1번 상품명"]!==item.상품명)
      ? `${item.상품명.split(" ")[0]} ${item["1번 상품명"]}` : item.상품명;

    const 색상목록 = parseOptions(item.색상).length? parseOptions(item.색상) : [""];
    const 사이즈목록 = expandSizes(item.사이즈);

    색상목록.forEach(col=>{
      if (!사이즈목록.length) {
        const base = applyOptionMode(제품명, col, null, 제품명, "");
        data.push({ ...base, 옵션가, 관리코드: item.상품명, 재고수량:99999, 사용여부:"Y" });
      } else {
        사이즈목록.forEach(sz=>{
          const base = applyOptionMode(제품명, col, sz, 제품명, "");
          data.push({ ...base, 옵션가, 관리코드: item.상품명, 재고수량:99999, 사용여부:"Y" });
        });
      }
    });
  });

  // 2) 중복 제거 (상품명+옵션가+색상+사이즈)
  {
    const seen = new Set();
    data = data.filter(r => {
      const key = [r.관리코드, r.옵션가, r.색상||"", r.사이즈||""].join("|");
      if (seen.has(key)) return false;
      seen.add(key);
      return true;
    });
  }

  // 3) 상품 그룹별 순번 매핑
  const groupSeq = {};
  data.forEach(r=>{
    if (!(r.관리코드 in groupSeq)) {
      groupSeq[r.관리코드] = Object.keys(groupSeq).length + 1;
    }
  });

  // 4) 순번 붙이기
  data = data.map(r=>{
    const seq = String(groupSeq[r.관리코드]).padStart(2,"0");
    return { ...r, 제품선택: `${seq}) ${r.제품선택.replace(/^\d+\)\s*/, "")}` };
  });

  // 5) 모드별 컬럼 정리
  if (mode==="colorOnly") data.forEach(r=>delete r.사이즈);
  if (mode==="sizeOnly")  data.forEach(r=>delete r.색상);
  if (mode!=="colorOnly" && !data.some(r=>r.사이즈)) data.forEach(r=>delete r.사이즈);

  // 6) 엑셀 생성
  const ws = XLSX.utils.json_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "옵션데이터");
  const out = XLSX.write(wb,{bookType:"xls",type:"array"});
  saveAs(new Blob([out],{type:"application/octet-stream"}), `${대표.상품명}.xls`);
}
    

// 일괄 ZIP 다운로드
function generateZip() {
  const rows = getDataFromTable().filter(r => !r.제외);
  if (!rows.length) return alert("출력할 데이터가 없습니다.");

  const 할인률 = parseFloat(document.getElementById("discountRate").value) || 0;
  const mode = getOptionDisplayMode();
  const zip = new JSZip();

  rows.forEach(대표=>{
    const 대표정가 = calculateOriginalPrice(대표.판매가, 할인률);
    const items = rows.sort((a,b)=>(a===대표?-1:b===대표?1:0));
    let data = [];

    items.forEach(item=>{
      const 옵션가 = item.판매가 - 대표.판매가;
      if (!isValidOptionPrice(대표정가, 옵션가)) return;

      const 제품명 = (item===대표 && item["1번 상품명"] && item["1번 상품명"]!==item.상품명)
        ? `${item.상품명.split(" ")[0]} ${item["1번 상품명"]}` : item.상품명;

      const 색상목록 = parseOptions(item.색상).length? parseOptions(item.색상) : [""];
      const 사이즈목록 = expandSizes(item.사이즈);

      색상목록.forEach(col=>{
        if (!사이즈목록.length) {
          const base = applyOptionMode(제품명, col, null, 제품명, "");
          data.push({ ...base, 옵션가, 관리코드:item.상품명, 재고수량:99999, 사용여부:"Y" });
        } else {
          사이즈목록.forEach(sz=>{
            const base = applyOptionMode(제품명, col, sz, 제품명, "");
            data.push({ ...base, 옵션가, 관리코드:item.상품명, 재고수량:99999, 사용여부:"Y" });
          });
        }
      });
    });

    // 중복 제거
    {
      const seen = new Set();
      data = data.filter(r=>{
        const key=[r.관리코드,r.옵션가,r.색상||"",r.사이즈||""].join("|");
        if(seen.has(key)) return false;
        seen.add(key);
        return true;
      });
    }

    // 그룹별 순번 매핑
    const groupSeq = {};
    data.forEach(r=>{
      if (!(r.관리코드 in groupSeq)) {
        groupSeq[r.관리코드] = Object.keys(groupSeq).length + 1;
      }
    });

    // 순번 붙이기
    data = data.map(r=>{
      const seq = String(groupSeq[r.관리코드]).padStart(2,"0");
      return { ...r, 제품선택: `${seq}) ${r.제품선택.replace(/^\d+\)\s*/, "")}` };
    });

    // 모드별 컬럼 정리
    if (mode==="colorOnly") data.forEach(r=>delete r.사이즈);
    if (mode==="sizeOnly")  data.forEach(r=>delete r.색상);
    if (mode!=="colorOnly" && !data.some(r=>r.사이즈)) data.forEach(r=>delete r.사이즈);

    // 워크북 & ZIP
    const ws = XLSX.utils.json_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "옵션데이터");
    const out = XLSX.write(wb,{bookType:"xls",type:"array"});
    zip.file(`${대표.상품명}.xls`, out);
  });

  zip.generateAsync({type:"blob"}).then(blob=>saveAs(blob,"옵션_일괄다운로드.zip"));
}
// 추가상품 엑셀 다운로드 (모든 제외되지 않은 상품 포함)
function downloadAddProductExcel() {
  const rows = getDataFromTable().filter(r => !r.제외);
  if (rows.length === 0) return alert("출력할 데이터가 없습니다.");

  const 대표 = rows.find(r => r.대표) || rows[0];
  const 대표상품명 = 대표.상품명;
  const items = rows.sort((a, b) => (a === 대표 ? -1 : b === 대표 ? 1 : 0));

  let index = 1;
  const data = [];

  items.forEach(item => {
    const 순번 = index < 10 ? `0${index}` : `${index}`;
    const 색상목록 = parseOptions(item.색상);
    const 사이즈목록 = expandSizes(item.사이즈);
    const 색상배열 = 색상목록.length > 0 ? 색상목록 : [""];

    색상배열.forEach(color => {
      if (사이즈목록.length === 0) {
        data.push({
          추가상품명: "제품선택",
          추가상품값: `${순번}) ${item.상품명} / ${color}`.trim(),
          추가상품가: item.판매가,
          재고수량: 99999,
          사용여부: "Y",
          관리코드: item.상품명
        });
      } else {
        사이즈목록.forEach(size => {
          data.push({
            추가상품명: "제품선택",
            추가상품값: `${순번}) ${item.상품명} / ${color}`.trim(),
            추가상품가: item.판매가,
            재고수량: 99999,
            사용여부: "Y",
            관리코드: item.상품명
          });
        });
      }
    });

    index++;
  });

  const ws = XLSX.utils.json_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "추가상품");
  const wbout = XLSX.write(wb, { bookType: 'xls', type: 'array' });
  const safeName = (대표상품명 || "추가상품").replace(/[\\/:*?"<>|]/g, "").trim();
  saveAs(new Blob([wbout], { type: "application/octet-stream" }), `추가상품_${safeName}.xls`);
}

// 단품등록용 엑셀 다운로드 - 대표상품만 순번 없이 출력  
function downloadSingleProductExcel() {
  const rows = getDataFromTable().filter(r => !r.제외);
  const 대표 = rows.find(r => r.대표) || rows[0];
  if (!대표) return alert("대표 상품이 없습니다.");

  const 색상목록 = parseOptions(대표.색상);
  const 사이즈목록 = expandSizes(대표.사이즈);
  const 품절조합 = parseOptions(대표.품절된조합);
  const 상품명 = 대표["1번 상품명"] || 대표.상품명;
  const mode = getOptionDisplayMode();

  const data = [];

  색상목록.forEach(color => {
    if (사이즈목록.length === 0) {
      const 품절 = 품절조합.includes(color);
      const row = {
        제품선택: mode === "both" ? `${상품명} / ${color}` : 상품명,
        옵션가: 0,
        재고수량: 품절 ? 0 : 99999,
        관리코드: 대표.상품명,
        사용여부: "Y"
      };
      if (mode === "colorOnly") row.색상 = color;
      if (mode === "sizeOnly" || mode === "both") row.사이즈 = 대표.사이즈;
      data.push(row);
    } else {
      사이즈목록.forEach(size => {
        const 품절 = 품절조합.includes(color) || 품절조합.includes(size) || 품절조합.includes(`${color}-${size}`);
        const row = {
          제품선택: mode === "both" ? `${상품명} / ${color}` : 상품명,
          옵션가: 0,
          재고수량: 품절 ? 0 : 99999,
          관리코드: 대표.상품명,
          사용여부: "Y"
        };
        if (mode === "colorOnly") row.색상 = color;
        if (mode === "sizeOnly" || mode === "both") row.사이즈 = size;
        data.push(row);
      });
    }
  });

  const header = ["제품선택"];
  if (mode === "colorOnly") header.push("색상");
  if (mode === "sizeOnly" || mode === "both") header.push("사이즈");
  header.push("옵션가", "재고수량", "관리코드", "사용여부");

  const rowsArray = data.map(row => {
    const line = [row.제품선택];
    if (mode === "colorOnly") line.push(row.색상);
    if (mode === "sizeOnly" || mode === "both") line.push(row.사이즈);
    line.push(row.옵션가, row.재고수량, row.관리코드, row.사용여부);
    return line;
  });

  const ws = XLSX.utils.aoa_to_sheet([header, ...rowsArray]);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "단품옵션");
  const safeFileName = (대표.상품명 || "단품등록").replace(/[\/:*?"<>|]/g, "").trim();
  const wbout = XLSX.write(wb, { bookType: 'xls', type: 'array' });
  saveAs(new Blob([wbout], { type: "application/octet-stream" }), `단품등록_${safeFileName}.xls`);
}

// 단품등록용 전체 엑셀 ZIP 다운로드
function downloadSingleProductExcelAll() {
  const rows = getDataFromTable().filter(r => !r.제외);
  if (rows.length === 0) return alert("출력할 데이터가 없습니다.");

  const mode = getOptionDisplayMode();
  const zip = new JSZip();
  const 상품그룹 = [...new Set(rows.map(r => r.상품명))];

  상품그룹.forEach(상품명 => {
    const 그룹 = rows.filter(r => r.상품명 === 상품명);
    const 대표 = 그룹.find(r => r.대표) || 그룹[0];
    const 색상목록 = parseOptions(대표.색상);
    const 사이즈목록 = expandSizes(대표.사이즈);
    const 품절조합 = parseOptions(대표.품절된조합);
    const 대표상품명 = 대표["1번 상품명"] || 대표.상품명;

    const data = [];
    const 색상배열 = 색상목록.length > 0 ? 색상목록 : [""];

    색상배열.forEach(color => {
      if (사이즈목록.length === 0) {
        const 품절 = 품절조합.includes(color);
        const row = {
          제품선택: mode === "both" ? `${대표상품명} / ${color}` : 대표상품명,
          옵션가: 0,
          재고수량: 품절 ? 0 : 99999,
          관리코드: 대표.상품명,
          사용여부: "Y"
        };
        if (mode === "colorOnly") row.색상 = color;
        if (mode === "sizeOnly" || mode === "both") row.사이즈 = 대표.사이즈;
        data.push(row);
      } else {
        사이즈목록.forEach(size => {
          const 품절 = 품절조합.includes(color) || 품절조합.includes(size) || 품절조합.includes(`${color}-${size}`);
          const row = {
            제품선택: mode === "both" ? `${대표상품명} / ${color}` : 대표상품명,
            옵션가: 0,
            재고수량: 품절 ? 0 : 99999,
            관리코드: 대표.상품명,
            사용여부: "Y"
          };
          if (mode === "colorOnly") row.색상 = color;
          if (mode === "sizeOnly" || mode === "both") row.사이즈 = size;
          data.push(row);
        });
      }
    });

    const header = ["제품선택"];
    if (mode === "colorOnly") header.push("색상");
    if (mode === "sizeOnly" || mode === "both") header.push("사이즈");
    header.push("옵션가", "재고수량", "관리코드", "사용여부");

    const rowsArray = data.map(row => {
      const line = [row.제품선택];
      if (mode === "colorOnly") line.push(row.색상);
      if (mode === "sizeOnly" || mode === "both") line.push(row.사이즈);
      line.push(row.옵션가, row.재고수량, row.관리코드, row.사용여부);
      return line;
    });

    const ws = XLSX.utils.aoa_to_sheet([header, ...rowsArray]);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "단품옵션");
    const wbout = XLSX.write(wb, { bookType: 'xls', type: 'array' });
    const safeFileName = (대표.상품명 || "단품등록").replace(/[\/:*?"<>|]/g, "").trim();
    zip.file(`단품등록_${safeFileName}.xls`, wbout);
  });

  zip.generateAsync({ type: "blob" }).then(content => {
    saveAs(content, "단품등록_전체다운로드.zip");
  });
}

// 색상/사이즈 분리 함수
function parseOptions(input) {
  if (!input || typeof input !== 'string') return [];
  return input.split(/[,/]/).map(s => s.trim()).filter(Boolean);
}
// 옵션 노출 방식 확인 함수
function getOptionDisplayMode() {
  const selected = document.querySelector('input[name="optionDisplay"]:checked');
  return selected ? selected.value : "both";
} 
// 옵션 구성 방식 적용 함수
    function applyOptionMode(제품명, 색상, 사이즈, 상품명, 순번) {
      const mode = getOptionDisplayMode();
      let 제품선택값 = `${순번}) ${제품명}`;
      let 색상열 = 색상 || "";
      let 사이즈열 = 사이즈 || "";

      if (mode === "colorOnly") {
        return { 제품선택: 제품선택값, 색상: 색상열 };
      } else if (mode === "sizeOnly") {
        return 사이즈
          ? { 제품선택: 제품선택값, 사이즈: 사이즈열 }
          : { 제품선택: 제품선택값 };
      } else {
        제품선택값 += 색상 ? ` / ${색상}` : "";
        return 사이즈
          ? { 제품선택: 제품선택값, 사이즈: 사이즈열 }
          : { 제품선택: 제품선택값 };
      }
    }
function expandSizes(sizeStr) {
  if (!sizeStr || typeof sizeStr !== 'string') return [];

  // 쉼표 또는 슬래시로 구분된 경우
  if (sizeStr.includes(',') || sizeStr.includes('/')) {
    return sizeStr.split(/[,/]/).map(s => s.trim()).filter(Boolean);
  }

  // 범위 (예: 230~240) 처리
  const rangeMatch = sizeStr.match(/^(\d{3})~(\d{3})$/);
  if (rangeMatch) {
    const start = parseInt(rangeMatch[1]);
    const end = parseInt(rangeMatch[2]);
    const step = 5;
    const result = [];
    for (let i = start; i <= end; i += step) {
      result.push(i.toString());
    }
    return result;
  }

  return [sizeStr.trim()];
}

  </script>
</body>
</html>
